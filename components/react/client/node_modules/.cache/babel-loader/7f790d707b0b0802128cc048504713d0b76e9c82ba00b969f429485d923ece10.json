{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.fromUtf8 = exports.toUtf8 = void 0;\nfunction isValidUtf8(data) {\n  const toStringAndBack = Buffer.from(Buffer.from(data).toString(\"utf8\"), \"utf8\");\n  return Buffer.compare(Buffer.from(data), toStringAndBack) === 0;\n}\nfunction toUtf8(str) {\n  // Browser and future nodejs (https://github.com/nodejs/node/issues/20365)\n  if (typeof TextEncoder !== \"undefined\") {\n    return new TextEncoder().encode(str);\n  }\n  // Use Buffer hack instead of nodejs util.TextEncoder to ensure\n  // webpack does not bundle the util module for browsers.\n  return new Uint8Array(Buffer.from(str, \"utf8\"));\n}\nexports.toUtf8 = toUtf8;\nfunction fromUtf8(data) {\n  // Browser and future nodejs (https://github.com/nodejs/node/issues/20365)\n  if (typeof TextDecoder !== \"undefined\") {\n    return new TextDecoder(\"utf-8\", {\n      fatal: true\n    }).decode(data);\n  }\n  // Use Buffer hack instead of nodejs util.TextDecoder to ensure\n  // webpack does not bundle the util module for browsers.\n  // Buffer.toString has no fatal option\n  if (!isValidUtf8(data)) {\n    throw new Error(\"Invalid UTF8 data\");\n  }\n  return Buffer.from(data).toString(\"utf8\");\n}\nexports.fromUtf8 = fromUtf8;","map":{"version":3,"mappings":";;;;;;AAQA,SAASA,WAAW,CAACC,IAAgB;EACnC,MAAMC,eAAe,GAAGC,MAAM,CAACC,IAAI,CAACD,MAAM,CAACC,IAAI,CAACH,IAAI,CAAC,CAACI,QAAQ,CAAC,MAAM,CAAC,EAAE,MAAM,CAAC;EAC/E,OAAOF,MAAM,CAACG,OAAO,CAACH,MAAM,CAACC,IAAI,CAACH,IAAI,CAAC,EAAEC,eAAe,CAAC,KAAK,CAAC;AACjE;AAEA,SAAgBK,MAAM,CAACC,GAAW;EAChC;EACA,IAAI,OAAOC,WAAW,KAAK,WAAW,EAAE;IACtC,OAAO,IAAIA,WAAW,EAAE,CAACC,MAAM,CAACF,GAAG,CAAC;;EAGtC;EACA;EACA,OAAO,IAAIG,UAAU,CAACR,MAAM,CAACC,IAAI,CAACI,GAAG,EAAE,MAAM,CAAC,CAAC;AACjD;AATAI;AAWA,SAAgBC,QAAQ,CAACZ,IAAgB;EACvC;EACA,IAAI,OAAOa,WAAW,KAAK,WAAW,EAAE;IACtC,OAAO,IAAIA,WAAW,CAAC,OAAO,EAAE;MAAEC,KAAK,EAAE;IAAI,CAAE,CAAC,CAACC,MAAM,CAACf,IAAI,CAAC;;EAG/D;EACA;EACA;EACA,IAAI,CAACD,WAAW,CAACC,IAAI,CAAC,EAAE;IACtB,MAAM,IAAIgB,KAAK,CAAC,mBAAmB,CAAC;;EAEtC,OAAOd,MAAM,CAACC,IAAI,CAACH,IAAI,CAAC,CAACI,QAAQ,CAAC,MAAM,CAAC;AAC3C;AAbAO","names":["isValidUtf8","data","toStringAndBack","Buffer","from","toString","compare","toUtf8","str","TextEncoder","encode","Uint8Array","exports","fromUtf8","TextDecoder","fatal","decode","Error"],"sources":["../src/utf8.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script","externalDependencies":[]}